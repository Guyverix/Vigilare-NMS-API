-- MySQL dump 10.13  Distrib 5.5.62, for debian-linux-gnu (i686)
--
-- Host: localhost    Database: event
-- ------------------------------------------------------
-- Server version	5.5.62-0ubuntu0.12.04.1-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `trapEventMap`
-- We DO want to clobber the table if running this version as this
-- should only be used at install

DROP TABLE IF EXISTS `trapEventMap`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `trapEventMap` (
  `oid` varchar(255) NOT NULL,
  `display_name` varchar(255) NOT NULL DEFAULT 'undefined',
  `severity` tinyint(6) NOT NULL DEFAULT '1',
  `pre_processing` text,
  `type` int(9) DEFAULT '1',
  `parent_of` text,
  `child_of` text,
  `age_out` varchar(32) NOT NULL DEFAULT '14400',
  `post_processing` text,
  UNIQUE KEY `oid` (`oid`),
  UNIQUE KEY `uniquePair` (`oid`,`display_name`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `trapEventMap`
--

LOCK TABLES `trapEventMap` WRITE;
/*!40000 ALTER TABLE `trapEventMap` DISABLE KEYS */;
INSERT INTO `trapEventMap` VALUES ('*','unmapped',1,'',1,'','','7200',''),('.1.2.3.4.5.0.1','testEventName',5,'$event_summary= \'this is only a test event\';\r\n$event_severity=3;\r\n// blah\r\n$event_summary = \"Appending in pre-processing mapping\" ;\r\nif ( $event_severity == 3) {\r\n // blah\r\n  $event_severity =4;\r\n}',1,'','','1800','// Nothing should ever end up in here.;\r\n// Not really being used AFAIK;\r\n\r\n// Nothing should ever end up in here.;\r\n// Not really being used AFAIK;\r\n\r\n// Nothing should ever end up in here.;\r\n// Not really being used AFAIK;\r\n\r\n// Nothing should ever end up in here.;\r\n// Not really being used AFAIK;'),('.1.3.6.1.2.1.17.0.2','topologyStateChange',2,'$event_summary = \"topology change detected\" ;\r\nif ( ! is_array($details)) { $details=json_decode($details, true); }\r\n\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"3.6.1.2.1.31.1.1.1.1\")) {\r\n    $nam = preg_replace(\'/.*..3.6.1.2.1.31.1.1.1.1.[0-9]?[0-9]?[0-9]?[0-9]?[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det = preg_replace( \'/\"/\', \'\', $nam);\r\n    if ( ! empty($det)) {\r\n     $event_summary = $event_summary . \" interface \" . $det;\r\n    }\r\n  }\r\n}\r\n\r\n',1,'','','600',''),('.1.3.6.1.2.1.47.2.0.1','entConfigChange',1,'$event_summary = \"entLastChangeTime timer has reset.  No action needed\" ;\r\n',1,'','','1800',''),('.1.3.6.1.4.1.171','warmstart',2,'',1,'','','3600',''),('.1.3.6.1.4.1.24591.105.100.10.0','marchex-trapGeneratorClear',0,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.1','marchex-trapGeneratorDebug',1,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.2','marchex-trapGeneratorWarning',2,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.3','marchex-trapGeneratorMinor',3,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.4','marchex-trapGeneratorMajor',4,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.5','marchex-trapGenerator',5,'',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.24591.105.100.10.7','marchex-trapGenerator-testing',3,'foreach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.4.1.24591.1.1.3\") ) {\r\n    $nam=explode(\"24591.1.1.3\", $loc);\r\n    $event_name=\"$nam[1]\";\r\n    $event_name=trim($event_name);\r\n  }\r\n}\r\n//$event_severity = 0;',1,NULL,NULL,'86400',NULL),('.1.3.6.1.4.1.30911.1.200.200.1','iwillfearnoevil-trapGenerator-testing',4,'$event_summary=\"Initial summary defined in mapping.\" ;\r\nif ( ! is_array($details)) {\r\n  $details = json_decode($details,true);\r\n  $event_summary = $event_summary . \" converted details to array \" ;\r\n}\r\nif ( ! empty ($details)) {\r\nforeach ($details as $loc) {\r\n  if ( strpos($loc, \"30911.1.1.3\") !== false) {\r\n    $event_summary = $event_summary . \" Matched against strpos and loc \" ;\r\n  }\r\n}\r\n}\r\nif (isset($details)) {\r\n$event_summary = $event_summary . \" details are available \" ;\r\n}\r\n$event_summary = $event_summary . \" final append test\" ;\r\n$event_summary = $event_summary . \" EVAL WORKS\" ;',1,'','','600',''),('.1.3.6.1.4.1.30911.1.200.200.1.0.1','testIwillFearNoEvil',4,'$application = \"true\" ;\r\n$osEvent = \"true\" ;\r\n$customerVisible = \"true\" ;',1,'','','14400','$event_severity = 3;'),('.1.3.6.1.4.1.30911.100.5.0.1','publicIpChange',2,'$event_summary = $details;\r\n$details = json_decode($details, true);\r\nforeach ($details as $loc) {\r\n  if ( strpos($loc, \"1.3.6.1.4.1.24591.1.1.2\") !== false) {\r\n    $nam=explode(\"24591.1.1.2\", $loc);\r\n    $event_summary=\"$nam[1]\" ;\r\n    $event_summary=preg_replace(\'/\"/\' ,\'\', $event_summary);\r\n    $event_summary=trim($event_summary);\r\n  }\r\n}\r\n$event_age_out= 604800;',1,'','','86400',''),('.1.3.6.1.4.1.3955.2.2.1','network-port-block',2,'',1,'','','3600',''),('.1.3.6.1.4.1.4526.22.300.0.80','driveSpaceLow',5,'$event_summary = \"Drive Space low\" ;\r\nforeach ($details as $loc) {\r\n   if ( false !== strpos($loc, \"1.3.6.1.4.1.4526.22.407.1\") ) {\r\n    $filter=explode(\".22.407.1.3\", $loc);\r\n    $string = $filter[1];\r\n  }\r\n}\r\nif ( ! empty($string)){\r\n  $event_summary =  $string;\r\n}',1,'','','7200',''),('.1.3.6.1.4.1.5127.1.1.1.10.1.200.115','.1.3.6.1.4.1.5127.1.1.1.10.1.200.115',3,'$event_summary = \'Network link state changed to down\';',1,'','','3600',''),('.1.3.6.1.4.1.674.10895.0.1000','failedLoginFromHost',4,'$event_summary = \'User attempted login through Web\';\r\n$sum=\'\';\r\nif ( ! is_array($details)) {\r\n  $details = json_decode($details, true);\r\n}\r\nforeach ($details as $loc) {\r\nif ( strpos($loc, \'10895.5000.1.1.1.0\') !== false ) {\r\n$sum1=explode(\'5000.1.1.1.0\', $loc);\r\n$sum = $sum1[1];\r\n$event_summary = preg_replace(\'/\"/\', \'\', $sum);\r\n}\r\n}',1,'','','86400',''),('.1.3.6.1.4.1.674.10895.0.570','linkFailureSwitchBackUp',1,'$event_summary=\"Link Failure.  Switch backup \" ;\r\nif ( ! is_array($details)) { $details=json_decode($details,true); }\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.4.1.674.10895.5000.1.1.3\") ) {\r\n    $nam=explode(\' \', $loc, 2);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n}\r\n',1,'','','1800',''),('.1.3.6.1.4.1.674.10895.0.760','dot1dStpPortStateForwarding',2,'// Set a default summary\r\n$event_summary=\"STP: port changed from forwarding to notForwarding.  \" ;\r\nif ( ! is_array($details)) { $details = json_decode($details, true); }\r\n// Attempt to give more summary info\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"674.10895.5000.1.1.3.0\") ) {\r\n    $nam=explode(\"10895.5000.1.1.3.0\", $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $det=\"Switch port \" . $det;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n}\r\n',1,'','','3600',''),('.1.3.6.1.4.1.674.10895.0.770','dot1dStpPortStateNotForwarding',2,'// Set a default summary\r\n$event_summary=\"STP: port changed from forwarding to blocking.  \" ;\r\n\r\nif ( ! is_array($details)) { $details = json_decode($details,true); }\r\n// Attempt to give more summary info\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"674.10895.5000.1.1.3.0\") ) {\r\n    $nam=explode(\"10895.5000.1.1.3.0\", $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $det=\"Switch port $det\" ;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n}\r\n',1,'','','3600',''),('.1.3.6.1.4.1.674.10895.1000','invalidUserLoginAttempted',3,'// Set a default summary\r\n$event_summary=\"Login failure. \";\r\n\r\n// Attempt to give more summary info\r\nforeach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"3.6.1.4.1.674.10895.5000.1.1.1\") ) {\r\n    $nam1=explode(\'3.6.1.4.1.674.10895.5000.1.1.1\', $loc);\r\n    $nam=explode(\' \',$nam1[1],2);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $event_summary=\"$event_summary $det\";\r\n  } \r\n}\r\n',1,'','','86400',''),('.1.3.6.1.4.1.674.10895.5000.2.6132.1.1.1.0.11','stpInstanceTopologyChangeTrap',1,'// Set a default summary\r\n$event_summary=\"Received fastPathSwitchingTrap.  \" ;\r\nif ( ! is_array($details_array)) { $details_array=json_decode($details_array,true); }\r\n// Attempt to give more summary info\r\nforeach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.2.1.17.7.1.4.2.1\") ) {\r\n    $nam1=preg_replace(\'/.*..2.1.17.7.1.4.2.1.[0-9]?[0-9]? /\',\'\',$loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam1);\r\n    $det=\"VLAN \" . $det;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n}\r\n',1,'','','1800',''),('.1.3.6.1.4.1.674.10895.5000.2.6132.1.1.1.0.13','failedUserLoginTrap',2,'$event_summary=\"User login authentication failure on host\" ;',1,'','','86400',''),('.1.3.6.1.4.1.674.10895.530','restartRequired',4,'',1,'','','86400',''),('.1.3.6.1.4.1.674.10895.570','linkFailureSwitchBackUp',1,'$event_summary=\"Link Failure.  Switch backup \";\r\nforeach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.4.1.674.10895.5000.1.1.3\") ) {\r\n    $nam=explode(\' \', $loc, 2);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $event_summary=\"$event_summary $det\";\r\n  }\r\n}\r\n',1,'','','1800',''),('.1.3.6.1.4.1.674.10895.760','dot1dStpPortStateForwarding',2,'// Set a default summary\r\n$event_summary=\"STP: port changed from forwarding to notForwarding.  \";\r\n\r\n// Attempt to give more summary info\r\nforeach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"674.10895.5000.1.1.3.0\") ) {\r\n    $nam=explode(\"10895.5000.1.1.3.0\", $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $det=\"Switch port \" . $det;\r\n    $event_summary=\"$event_summary $det\";\r\n  }\r\n}\r\n',1,'','','3600',''),('.1.3.6.1.4.1.674.10895.770','dot1dStpPortStateNotForwarding',2,'// Set a default summary\r\n$event_summary=\"STP: port changed from forwarding to blocking.  \";\r\n\r\n// Attempt to give more summary info\r\nforeach ($details_array as $loc) {\r\n  if ( false !== strpos($loc, \"674.10895.5000.1.1.3.0\") ) {\r\n    $nam=explode(\"10895.5000.1.1.3.0\", $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam[1]);\r\n    $det=\"Switch port $det\";\r\n    $event_summary=\"$event_summary $det\";\r\n  }\r\n}\r\n',1,'','','3600',''),('.1.3.6.1.4.1.8072.3.2.10','coldstart',1,'$event_summary=\"SNMP coldstart trap received.\";',1,'warmstart','ping','3600',''),('.1.3.6.1.4.1.8072.4.0.2','nsNotifyRestart',2,'$event_summary = \"nsRestart command issued at \" . $event_ip;\r\n',1,'','','600',''),('.1.3.6.1.4.1.9.0.0','powerOn',3,'$event_summary = \"power event seen\" ;',1,'','','1800',''),('.1.3.6.1.4.1.9.0.1','TcpConnectionClose',1,'$event_summary = \'User logoff or failed login attempt\';\r\nif ( ! is_array($details)) {\r\n  $details = json_decode($details, true);\r\n}\r\nforeach ($details as $loc) {\r\n   if ( false !== strpos($loc, \"9.2.9.2.1.18.1\") ) {\r\n    $filter=explode(\"9.2.1.18.1\", $loc);\r\n    $string = preg_replace(\'/\"/\',\'\', $filter[1]);\r\n  }\r\n}\r\nif ( ! empty($string)){\r\n  $event_summary =  \"User logoff userid \" .  $string;\r\n}\r\n',1,'','','300',''),('.1.3.6.1.4.1.9.9.43.2.0.1','ciscoConfigManEvent',2,'$event_summary = \"Cisco device detected a configuration change\" ;',1,'','','600',''),('.1.3.6.1.4.1.9.9.46.2.0.10','default-setup-values',2,'$event_summary = \"Values being loaded\" ;\r\nif ( ! is_array($details)) { $details=json_decode($details, true); }\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"4.1.9.9.46.1.3.1.1.4.1\")) {\r\n    $nam = preg_replace(\'/.*..46.1.3.1.1.4.1.[0-9]?[0-9]?[0-9]?[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det = preg_replace( \'/\"/\', \'\', $nam);\r\n    if ( $det == \"default\" ) {\r\n     $event_name = \"default-values\" ;\r\n    }\r\n    elseif ( ! empty($det)) {\r\n      $event_name = $det ;\r\n    }\r\n  }\r\n}',1,'','','300',''),('.1.3.6.1.6.3.1.1.5','dellConfigChange',2,'$event_summary=\"SNMP trap received from Dell that implies that there was a configuration change saved\";',1,'','','3600',''),('.1.3.6.1.6.3.1.1.5.1','coldStart',2,'$event_summary=\"Coldstart trap received from \" . $event_ip;',1,'','','600',''),('.1.3.6.1.6.3.1.1.5.3','linkChange',3,'$event_summary=\"Link change event.  \" ;\r\nif ( ! is_array($details)) { $details=json_decode($details, true); }\r\n// Attempt to give more summary info\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.2.1.2.2.1.1\") ) {  // Index number\r\n    $nam=preg_replace(\'/.*..2.1.2.2.1.1.[0-9]?[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam);\r\n    $det=\"Switch index \" . $det;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n  if ( false !== strpos($loc, \"1.3.6.1.2.1.2.2.1.7\") ) {\r\n    $nam=preg_replace(\'/.*..2.2.1.7.[0-9]?[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam);\r\n    $event_name = $event_name . \'-\' . $det;\r\n    $det = \"Operator status \" . $det . \" \" ;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n    if ( false !== strpos($loc, \"1.3.6.1.2.1.2.2.1.8\") ) {\r\n    $nam=preg_replace(\'/.*..2.1.2.2.1.8.[0-9]?[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam);\r\n    $event_name = $event_name . \'-\' . $det;\r\n    $det = \"Admin status \" . $det . \" \" ;\r\n    $event_summary=\"$event_summary $det\" ;\r\n  }\r\n}\r\n',1,'','','1800',''),('.1.3.6.1.6.3.1.1.5.4','linkUp',2,'$event_summary=\"Link up event seen. \" ;\r\nif ( ! is_array($details)) { $details=json_decode($details,true); }\r\n\r\nforeach ($details as $loc) {\r\n  if ( false !== strpos($loc, \"1.3.6.1.2.1.2.2.1.7\") ) {\r\n    $nam=preg_replace(\'/.*..2.2.1.7.[0-9]?[0-9]? /\', \'\', $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam);\r\n    if ( $det == 1 || $det == \"up\" ) { \r\n      $status=\"up\" ;  \r\n    }\r\n    elseif ( $det == 0 ) { \r\n      $status=\"down\" ;  \r\n    }\r\n    else {\r\n      $status=\"adminDown\" ;  \r\n    }\r\n    $event_name = $event_name . \'-\' . $status;\r\n    $det=\"Admin Status: $status\" ;\r\n    $event_summary=$event_summary  .\" \" . $det;\r\n  }\r\n  if ( false !== strpos($loc, \"1.3.6.1.2.1.2.2.1.8\") ) {\r\n    $nam1=preg_replace(\'/.*..2.1.2.2.1.8.[0-9]?[0-9]? /\',\'\', $loc);\r\n    $det=preg_replace( \'/\"/\' , \'\' , $nam1);\r\n    if ( $det == 1 || $det == \"up\" ) { \r\n      $status=\"up\" ;  \r\n    }\r\n    elseif ( $det == 0 ) { \r\n      $status=\"down\" ;  \r\n    }\r\n    else {\r\n      $status=\"adminDown\" ;  \r\n    }\r\n    $event_name = $event_name . \'-\' . $status;\r\n    $det=\"Oper Status: $status\" ;\r\n    $event_summary=$event_summary . \" \" . $det ;\r\n  }\r\n}',1,'','','1800',''),('.1.3.6.1.6.3.1.1.5.5','authenticationFailure',1,'$osEvent = \'true\';',1,'','','1800',''),('.1.3.6.1.6.3.1.1.5.6','egpNeighborLoss',1,'',1,'','','86400',''),('1.3.6.1.4.1.674.10895.760','dot1dStpPortStateForwarding',2,'$event_summary=\'A switch or router port state is now Forwarding\';',1,'','','1800',''),('alivePoller-60','alivePoller-60',5,'',1,'','','14400',''),('alivePoller-60-pid','alivePoller-60-pid',2,'',1,'','','3600',''),('brotherPrinterStats','brotherPrinterStats',2,'',1,'','','3600',''),('checkCertExpire','checkCertExpire',5,'',1,'','','7200',''),('checkChrony','checkChrony',2,'',1,'','','7200',''),('checkDaemonApache','checkDaemonApache',1,'',1,'','','86400',''),('checkDaemonNginx','checkDaemonNginx',1,'',1,'','','86400',''),('checkDaemonPihole-FTL','checkDaemonPihole-FTL',1,'',1,'','','86400',''),('checkDaemonPoller','checkDaemonPoller',1,'',1,'','','86400',''),('checkDaemonSabnzbd','checkDaemonSabnzbd',1,'',1,'','','86400',''),('checkDaemonSonarr','checkDaemonSonarr',1,'',1,'','','86400',''),('checkFail2ban','checkFail2ban',2,'',1,'','','3600',''),('checkIdleServer','checkIdleServer',3,'',1,'','','3600',''),('checkImap','checkImap',1,'',1,'','','86400',''),('checkIpmitool','checkIpmitool',1,'',1,'','','86400',''),('checkNetworkConnections-443','checkNetworkConnections-443',2,'$event_summary =strstr($event_summary, \'|\', true);\r\n$event_summary = preg_replace(\'/\\[/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\\\\\\\\/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\"/\',\'\', $event_summary);\r\n',1,'','','3600',''),('checkNetworkConnections-test442','checkNetworkConnections-test442',3,'',1,'','','1800',''),('checkPlex','checkPlex',1,'',1,'','','86400',''),('checkPop','checkPop',1,'',1,'','','86400',''),('checkPort22','checkPort22',1,'',1,'','','86400',''),('checkPort80','checkPort80',4,'',1,'','','3600',''),('checkPort8080','checkPort8080',5,'',1,'','','3600',''),('checkPortLocal-22','checkPortLocal-22',4,'',1,'','','3600',''),('checkSmtp','checkSmtp',1,'',1,'','','86400',''),('checkSwap','checkSwap',5,'',1,'','','14400',''),('checkTransmission','checkTransmission',1,'',1,'','','86400',''),('checkWcCert','checkWcCert',1,'',1,'','','86400',''),('check_crontab','check_crontab',2,'$application = \"true\" ;\r\n\r\n$event_summary =strstr($event_summary, \'|\', true);\r\n$event_summary = preg_replace(\'/\\[/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\\\\\\\\/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\"/\',\'\', $event_summary);\r\n',1,'','','900',''),('check_disk','check_disk',3,'',1,'','','3600',''),('check_faults','check_faults',4,'//$event_summary =strstr($event_summary, \'|\', true);\r\n$event_summary = preg_replace(\'/\\[/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\\\\\\\\/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\"/\',\'\', $event_summary);\r\n',1,'','','14400',''),('check_haproxy','check_haproxy',4,'$event_summary =strstr($event_summary, \'|\', true);\r\n$event_summary = preg_replace(\'/\\[/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\\\\\\\\/\',\'\', $event_summary);\r\n$event_summary = preg_replace(\'/\"/\',\'\', $event_summary);\r\n',1,'','','7200',''),('check_http','check_http',4,'',1,'','','7200',''),('check_load','check_load',4,'',1,'','','1800',''),('check_load_kvm','check_load_kvm',1,'',1,'','','86400',''),('check_ping','check_ping',4,'',1,'','','3600',''),('check_postfix_queue','check_postfix_queue',3,'',1,'','','1800',''),('check_smtp','check_smtp',3,'',1,'','','7200',''),('check_users','check_users',2,'',1,'','','900',''),('check_zombie_procs','check_zombie_procs',3,'',1,'','','1800',''),('daemonUptime','daemonUptime',2,'',1,'','','7200',''),('drive_32','drive_32',2,'',1,'','','3600',''),('envMonFanStatusTable','envMonFanStatusTable',1,'',1,'','','3600',''),('envMonSupplyState','envMonSupplyState',3,'',1,'','','3600',''),('externalDns','externalDns',3,'',1,'','','3600',''),('externalDnsGoogleLookup','externalDnsGoogleLookup',1,'',1,'','','86400',''),('fooBar','fooBar',1,'',1,'','','86400',''),('genericPrinterStatus','genericPrinterStatus',1,'',1,'','','86400',''),('hostOs','hostOs',3,'',1,'','','900',''),('housekeeping-60','housekeeping-60',5,'',1,'','','3600',''),('hrStorageEntry','hrStorageEntry',1,'',1,'','','3600',''),('hrStorageEntry2','hrStorageEntry2',1,'',1,'','','3600',''),('hrStorageEntry3','hrStorageEntry3',1,'',1,'','','3600',''),('hrSystem','hrSystem',3,'',1,'','','1800',''),('ifName_32','ifName_32',1,'',1,'','','3600',''),('ifName_64','ifName_64',1,'',1,'','','3600',''),('internalDns','internalDns',4,'',1,'','','1800',''),('ipRoute','ipRoute',2,'',1,'','','1800',''),('ircPort','ircPort',1,'',1,'','','86400',''),('laEntry','laEntry',3,'',1,'','','3600',''),('laEntry2','laEntry2',1,'',1,'','','86400',''),('lm-sensors','lm-sensors',1,'',1,'','','1800',''),('memory','memory',1,'',1,'','','7200',''),('nrpePoller-300','nrpePoller-300',4,'',1,'','','3600',''),('nrpePoller-300-pid','nrpePoller-300-pid',3,'',1,'','','14400',''),('ping','ping',4,'if ( strpos($event_summary, \'pl=0\')) {\r\n  $event_summary = \"ping round trip time taking too long for \" . $known_hostname ;\r\n}\r\nelseif ( strpos($event_summary, \'timeout\')) {\r\n   $event_summary = \'ping timeout for device: \' . $known_hostname;\r\n}\r\nelse {\r\n  $event_summary = \'ping failure for device: \' . $known_hostname ;\r\n}\r\n\r\n$osHost = \"true\" ;\r\n$application = \"true\" ;\r\n',1,'','','43200','if ($counter >= 10) {\r\n  $event_severity = 5;\r\n}\r\nelse {\r\n  $event_severity =3 ;\r\n}'),('portsUsed','portsUsed',4,'',1,'','','600',''),('shellPoller-300','shellPoller-300',1,'',1,'','','3600',''),('shellPoller-300-pid','shellPoller-300-pid',2,'',1,'','','3600',''),('shellPoller-60','shellPoller-60',4,'',1,'','','3600',''),('shellPoller-60-pid','shellPoller-60-pid',3,'',1,'','','3600',''),('slow-ping','slow-ping',4,'if ( ! is_array($details)) {\r\n  $details = json_decode($details,true);\r\n}\r\n\r\nif ( strpos($details[\'eventSummary\'], \'loss = 0\') !== false) {\r\n  $event_summary = \'ping check is taking too long to get a response, but no packetloss seen\';\r\n}\r\nelseif ( strpos($details[\'eventSummary\'], \'Host Unreachable\') !== false) {\r\n  $event_summary = \'Host is unreachable\';\r\n}\r\nelse {\r\n  $event_summary = \'ping check showing packetloss as well as possibly slow response\';\r\n}\r\n$osEvent = \'true\';\r\n',1,'','','3600','if ($counter >= 3) {\r\n  $event_severity = 5;\r\n}\r\nelse {\r\n  $event_severity = 3;\r\n}'),('snmpPoller-300','snmpPoller-300',5,'',1,'','','14400',''),('snmpPoller-300-pid','snmpPoller-300-pid',5,'',1,'','','3600',''),('snmpPoller-iterationComplete-300','snmpPoller-iterationComplete-300',4,'',1,'','','3600',''),('snmptrapd','snmptrapd',5,'',1,'','','1800',''),('snmptrapd-60','snmptrapd-60',5,'',1,'','','3600',''),('ssIndex','ssIndex',2,'',1,'','','1800',''),('ssIndex2','ssIndex2',1,'',1,'','','3600',''),('sysLocation','sysLocation',3,'',1,'','','600',''),('tesMonitor','tesMonitor',1,'',1,'','','86400',''),('testMonitor','testMonitor',1,'',1,'','','86400',''),('wdNasData','wdNasData',3,'',1,'','','3600',''),('wdNasSoftware','wdNasSoftware',2,'',1,'','','3600',''),('wdNasVolume','wdNasVolume',2,'',1,'','','3600','');
/*!40000 ALTER TABLE `trapEventMap` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2024-04-29 10:43:21

INSERT INTO `versionUpdates` VALUE(002, '002_trapEventMap.sql', NOW()) ON DUPLICATE KEY UPDATE date=NOW() ;
